% Remember to use the lgrind style

\Head{}
\File{example.cpp.lineno}{2016}{6}{11}{14:34}{650}
\index{main}\Proc{main}\L{\LB{\N{1}_\V{:}_\K{void}_\V{main}(\K{int}_\V{argc},_\K{char}_*\V{argv}[\,])_\{}}
\L{\LB{\N{2}_\V{:}}\Tab{6}{\K{int}_\V{done}_=_\N{0};_\C{}//_Be_1_when_receives_a_kill_signal.\CE{}}}
\L{\LB{\N{3}_\V{:}}\Tab{6}{\K{int}_\V{nworkers}_=_\V{atoi}(\V{argv}[\N{1}]);}}
\L{\LB{\N{4}_\V{:}}\Tab{6}{\V{pthread\_create}(.\,.\,.,_\V{NULL},_\V{listener},_\V{NULL});}}
\L{\LB{\N{5}_\V{:}}\Tab{6}{\K{for}_(\V{i}_=_\N{0};_\V{i}_\<_\V{nworkers};_++\V{i})}}
\L{\LB{\N{6}_\V{:}}\Tab{8}{\V{pthread\_create}(.\,.\,.,_\V{NULL},_\V{worker},_\V{NULL});}}
\L{\LB{\N{7}_\V{:}}\Tab{6}{.\,.\,.;_\C{}//_Wait_for_threads_to_exit.\CE{}}}
\L{\LB{\N{8}_\V{:}_\}}}
\index{listener}\Proc{listener}\L{\LB{\N{9}_\V{:}_\K{void}_*\V{listener}(\K{void}_*\V{arg})_\{}}
\L{\LB{\N{10}\V{:}}\Tab{6}{.\,.\,.;_\C{}//_Call_bind()_and_listen().\CE{}}}
\L{\LB{\N{11}\V{:}}\Tab{6}{\K{while}_(!\V{done}_\&\&_\V{poll}(.\,.\,.))_\{}}
\L{\LB{\N{12}\V{:}}\Tab{10}{\K{int}_\V{sock}_=_\V{accept}(.\,.\,.);}}
\L{\LB{\N{13}\V{:}}\Tab{10}{\V{worklist}.\V{add}(\V{sock});}}
\L{\LB{\N{14}\V{:}}\Tab{6}{\}}}
\L{\LB{\N{15}\V{:}_\}}}
\index{worker}\Proc{worker}\L{\LB{\N{16}\V{:}_\K{void}_*\V{worker}(\K{void}_*\V{arg})_\{}}
\L{\LB{\N{17}\V{:}}\Tab{6}{\K{while}(!\V{done}_\&\&_\K{int}_\V{sock}_=_\V{worklist}.\V{get}())_\{}}
\L{\LB{\N{18}\V{:}}\Tab{8}{\V{recv}(\V{sock},_\V{buf},_.\,.\,.);}}
\L{\LB{\N{19}\V{:}}\Tab{8}{\V{process\_req}(\V{buf});}}
\L{\LB{\N{20}\V{:}}\Tab{6}{\}_}}
\L{\LB{\N{21}\V{:}_\}}}
