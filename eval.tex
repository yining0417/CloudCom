% \newpage
\section{Evaluation} \label{sec:eval}

% We evaluated an anti-virus scanning server that a b c d e f.

\begin{table}[b]
\footnotesize
\centering
\vspace{-.05in}
\begin{tabular}{lrrr}
{\bf Approach} & {\bf Response time (ms)} \\
\hline\\[-2.3ex]
Native execution                       & 1270.3        \\
\xxx bare framework only                       & 1208.4        \\
\xxx with Helgrind                                   & 1230.4     \\
% \xxx with Helgrind and Callgrind                       & XX        \\
Helgrind only                       & 21086.8       \\
\end{tabular}
\vspace{-.05in}
\caption{{\em \xxx performance.}} 
\label{tab:overhead}
\end{table}

We evaluated \xxx on \mediatomb~\cite{mediatomb}, a 
\upnp multimedia server that parallely uploads, shares, and transcodes 
pictures and videos. Our evaluation was done on a set of three 
Linux 3.2.14 machines within a 1Gbps bandwidth LAN, and each machine has 2.80 
GHz dual-socket hex-core Intel Xeon with 24 hyper-threading cores and 64GB 
memory. Because \mediatomb uses a web-based interface, we used a popular web 
server benchmark \ab~\cite{apachebench} to invoke concurrent requests 
which use \mencoder to transcode a randomly downloaded 15MB video from AVI to 
MP4. To mitigate network latency, the benchmark clients were ran within the 
LAN. We measured each workload's response time because it 
has direct impact on users. For the analysis, we selected 
Helgrind~\cite{valgrind:pldi} because it is one of the most popular race 
detection tool and it suffers from huge slowdown.

Table~\ref{tab:overhead} shows the performance results running \mediatomb in 
\xxx. When running the bare \xxx replication framework without any analysis, 
the performance is slightly faster than the native execution, because the 
\parrot runtime we leverage schedules \pthread synchronizations with its own 
flag-relay approach~\cite{parrot:sosp13}, which is highly optimized on 
multi-core. \parrot's evaluation has confirmed that this approach has much 
fewer context switches than the traditional \pthread runtime when running 
\mencoder, the same program that \mediatomb uses to transcode video.

When running Helgrind in one replica, the performance overhead of \xxx over the 
bare framework is merely \overhead, because the \paxos protocol \xxx leverages 
serve requests fast as long as the other replicas (the majority) reach 
consensus. When running Helgrind only with \mediatomb, the performance overhead 
compared to native execution is 1560.3\%. This result reflects that \xxx's 
replication architecture masks the huge performance slowdown of Helgrind, so 
that client programs feel that \mediatomb runs efficiently even with the 
powerful analysis turned on. Note that Helgrind is already carried in Valgrind, 
a traditional analysis framework that takes the ``fully-coupled" approach. 
Overall, this result reflects that \xxx is efficient, transparent to the 
Helgrind analysis, and complementary to an traditional analysis framework 
Valgrind.
