\section{Introduction} \label{sec:intro}

% implement application fault tolerance at the virtual machine level

% P1: virtualization is good
Server virtualization has emerged as a powerful technique for consolidating servers in 
data centers. The reduction of the number of physical hosts also contributes to cutting 
back the power consumptions in the data centers.

% Symantec proposes a solution, based on VMware products, where the applications are \emph{monitored},
% however this commercial solution applies for a specific list of supported applications, 
% and does not support HA in a generic way

At the same time, a failure of a hosting server becomes a serious problem in consolidated 
server systems using virtualization. There has been a tremendous progress in realizing fault 
tolerance in virtualized environments, but existing approaches still fail to meet the high 
availability requirements of applications running in the VM because they are oriented 
toward protecting the VM. Protecting the VM alone does not guarantee the availability at the 
application level. Detecting and remediating VM failure falls short of what is truly vital, 
detecting and remediating application and service failures.

State Machine Replication (SMR) is an attractive approach to achieving application fault tolerance. 
SMR runs replicas of the program and uses a distributed consensus protocol 
(typically \paxos) to ensure the same sequence of input requests for replicas, as long as a 
quorum (typically a majority) of the replicas agrees on the input request sequence.

However, \paxos is slow because each decision takes at least three message delays between when 
a replica proposes a command and when some replica learns which command has been chosen.

Fortunately, Remote Direct Memory Access (RDMA)-capable networks have dropped in price and made 
substantial inroads into datacenters. RDMA operations allow a machine to read (or write) from a 
pre-registered memory region of another machine without involving the CPU on the remote side. 
Compared to traditional message passing, RDMA achieves the smallest round-trip latency 
(~$\sim$3 \us), highest throughput, and lowest (zero) CPU overhead~\cite{pilaf:usenix14}.

A naive approach for building fault tolerant applications is to integrate the \paxos algorithm 
into every application. But \paxos is notoriously difficult to implement and understand.

To address nondeterminism, SMR systems either reply on deterministic multithreading and replay 
approach~\cite{rex:eurosys14} or manually annotate all shared states to detect divergence of execution 
states~\cite{eve:osdi12}. These approaches suffer from poor automation or high overhead.

% This paper presents \xxx, a software system that provides high availability

This paper presents \xxx, an SMR system that efficiently replicates programs running in the 
VM for high availability. Within each replica, \xxx interposes on the network packets to keep 
replicas in sync. Specifically, it considers each incoming network packet an input request, and runs 
a \paxos consensus protocol~\cite{paxos:practical} to ensure that a quorum of the replicas sees the 
same exact sequence of the incoming network packets. To deal with nondeterminism, it maintains a 
packet queue that captures outgoing packets and invokes the output checking protocol periodically.

The remainder of the paper is organized as follows. \S\ref{sec:impl} provides details on the 
implementation.
